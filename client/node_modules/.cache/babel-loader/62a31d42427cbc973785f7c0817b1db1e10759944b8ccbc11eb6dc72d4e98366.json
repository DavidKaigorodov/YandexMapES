{"ast":null,"code":"const handleZoneButtonClick = (mapRef, zoneRectangles, setZoneRectangles, objectsAdded, setObjectsAdded) => {\n  if (!objectsAdded) {\n    fetchZoneData(mapRef, setZoneRectangles);\n    setObjectsAdded(true);\n  } else {\n    clearZones(mapRef, zoneRectangles, setZoneRectangles);\n    setObjectsAdded(false);\n  }\n};\nconst clearZones = (mapRef, zoneRectangles, setZoneRectangles) => {\n  if (mapRef.current) {\n    zoneRectangles.forEach(rectangle => {\n      mapRef.current.geoObjects.remove(rectangle);\n    });\n    setZoneRectangles([]);\n  }\n};\nconst fetchZoneData = (mapRef, setZoneRectangles) => {\n  fetch('http://localhost:5000/api/Zone').then(response => response.json()).then(data => {\n    const polygonLayers = data.map(item => {\n      const {\n        polygon,\n        rating\n      } = item;\n      if (polygon && polygon.coordinates) {\n        return processPolygon(polygon.coordinates, rating);\n      } else {\n        console.error('Некорректные данные полигона:', item);\n        return null;\n      }\n    }).filter(layer => layer !== null);\n    if (mapRef.current) {\n      const newZoneRectangles = [];\n      polygonLayers.forEach(layer => {\n        mapRef.current.geoObjects.add(layer);\n        newZoneRectangles.push(layer);\n      });\n      setZoneRectangles(newZoneRectangles);\n    } else {\n      console.error('Карта не инициализирована');\n    }\n  }).catch(error => {\n    console.error('Ошибка при получении данных полигонов:', error);\n  });\n};\nconst processPolygon = (coordinates, rating) => {\n  const color = getRatingColor(rating);\n  try {\n    return new window.ymaps.GeoObject({\n      geometry: {\n        type: 'Polygon',\n        coordinates: coordinates.map(coord => coord.reverse())\n      },\n      properties: {\n        hintContent: `Рейтинг: ${rating}`,\n        balloonContent: `Рейтинг: ${rating}`\n      }\n    }, {\n      fillColor: color,\n      strokeColor: '#0000ff',\n      opacity: 0.5\n    });\n  } catch (error) {\n    console.error('Ошибка при создании полигона:', error);\n    return null;\n  }\n};\nconst getRatingColor = rating => {\n  if (rating === 0) {\n    return 'rgba(255, 0, 0, 0.5)'; // Красный цвет для рейтинга меньше 3\n  } else if (rating > 0 && rating < 0.5) {\n    return 'rgba(255, 255, 0, 0.5)'; // Желтый цвет для рейтинга от 3 до 5\n  } else {\n    return 'rgba(0, 255, 0, 0.5)'; // Зеленый цвет для рейтинга 5 и выше\n  }\n};\nexport { handleZoneButtonClick, clearZones, fetchZoneData, processPolygon, getRatingColor };","map":{"version":3,"names":["handleZoneButtonClick","mapRef","zoneRectangles","setZoneRectangles","objectsAdded","setObjectsAdded","fetchZoneData","clearZones","current","forEach","rectangle","geoObjects","remove","fetch","then","response","json","data","polygonLayers","map","item","polygon","rating","coordinates","processPolygon","console","error","filter","layer","newZoneRectangles","add","push","catch","color","getRatingColor","window","ymaps","GeoObject","geometry","type","coord","reverse","properties","hintContent","balloonContent","fillColor","strokeColor","opacity"],"sources":["C:/Users/Disve/Desktop/YandexMap1212312/client/src/zone.js"],"sourcesContent":["const handleZoneButtonClick = (mapRef, zoneRectangles, setZoneRectangles, objectsAdded, setObjectsAdded) => {\r\n    if (!objectsAdded) {\r\n      fetchZoneData(mapRef, setZoneRectangles);\r\n      setObjectsAdded(true);\r\n    } else {\r\n      clearZones(mapRef, zoneRectangles, setZoneRectangles);\r\n      setObjectsAdded(false);\r\n    }\r\n  };\r\n  \r\n  const clearZones = (mapRef, zoneRectangles, setZoneRectangles) => {\r\n    if (mapRef.current) {\r\n      zoneRectangles.forEach((rectangle) => {\r\n        mapRef.current.geoObjects.remove(rectangle);\r\n      });\r\n      setZoneRectangles([]);\r\n    }\r\n  };\r\n  \r\n  const fetchZoneData = (mapRef, setZoneRectangles) => {\r\n    fetch('http://localhost:5000/api/Zone')\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        const polygonLayers = data.map(item => {\r\n          const { polygon, rating } = item;\r\n          if (polygon && polygon.coordinates) {\r\n            return processPolygon(polygon.coordinates, rating);\r\n          } else {\r\n            console.error('Некорректные данные полигона:', item);\r\n            return null;\r\n          }\r\n        }).filter(layer => layer !== null);\r\n  \r\n        if (mapRef.current) {\r\n          const newZoneRectangles = [];\r\n          polygonLayers.forEach(layer => {\r\n            mapRef.current.geoObjects.add(layer);\r\n            newZoneRectangles.push(layer);\r\n          });\r\n          setZoneRectangles(newZoneRectangles);\r\n        } else {\r\n          console.error('Карта не инициализирована');\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error('Ошибка при получении данных полигонов:', error);\r\n      });\r\n  };\r\n  \r\n  const processPolygon = (coordinates, rating) => {\r\n    const color = getRatingColor(rating);\r\n    try {\r\n      return new window.ymaps.GeoObject({\r\n        geometry: {\r\n          type: 'Polygon',\r\n          coordinates: coordinates.map(coord => coord.reverse()),\r\n        },\r\n        properties: {\r\n          hintContent: `Рейтинг: ${rating}`,\r\n          balloonContent: `Рейтинг: ${rating}`,\r\n        },\r\n      }, {\r\n        fillColor: color,\r\n        strokeColor: '#0000ff',\r\n        opacity: 0.5,\r\n      });\r\n    } catch (error) {\r\n      console.error('Ошибка при создании полигона:', error);\r\n      return null;\r\n    }\r\n  };\r\n  \r\n  const getRatingColor = (rating) => {\r\n    if (rating === 0) {\r\n      return 'rgba(255, 0, 0, 0.5)'; // Красный цвет для рейтинга меньше 3\r\n    } else if (rating > 0 && rating < 0.5) {\r\n      return 'rgba(255, 255, 0, 0.5)'; // Желтый цвет для рейтинга от 3 до 5\r\n    } else {\r\n      return 'rgba(0, 255, 0, 0.5)'; // Зеленый цвет для рейтинга 5 и выше\r\n    }\r\n  };\r\n  \r\n  export { handleZoneButtonClick, clearZones, fetchZoneData, processPolygon, getRatingColor };\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}