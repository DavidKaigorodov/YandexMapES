{"ast":null,"code":"const handleZoneButtonClick = (mapRef, zoneRectangles, setZoneRectangles, objectsAdded, setObjectsAdded, settings) => {\n  if (!objectsAdded) {\n    fetchZoneData(mapRef, setZoneRectangles, settings);\n    setObjectsAdded(true);\n  } else {\n    clearZones(mapRef, zoneRectangles, setZoneRectangles);\n    setObjectsAdded(false);\n  }\n};\nconst clearZones = (mapRef, zoneRectangles, setZoneRectangles) => {\n  if (mapRef.current) {\n    zoneRectangles.forEach(rectangle => {\n      mapRef.current.geoObjects.remove(rectangle);\n    });\n    setZoneRectangles([]);\n  }\n};\nconst fetchZoneData = (mapRef, setZoneRectangles, settings) => {\n  fetch('http://localhost:5000/api/Zone').then(response => response.json()).then(data => {\n    const polygonLayers = data.map(item => {\n      const {\n        polygon,\n        rating\n      } = item;\n      if (polygon && polygon.coordinates) {\n        return processPolygon(polygon.coordinates, rating, settings);\n      } else {\n        console.error('Некорректные данные полигона:', item);\n        return null;\n      }\n    }).filter(layer => layer !== null);\n    if (mapRef.current) {\n      const newZoneRectangles = [];\n      polygonLayers.forEach(layer => {\n        mapRef.current.geoObjects.add(layer);\n        newZoneRectangles.push(layer);\n      });\n      setZoneRectangles(newZoneRectangles);\n    }\n  }).catch(error => {\n    console.error('Ошибка при получении данных полигонов:', error);\n  });\n};\nconst processPolygon = (coordinates, rating, settings) => {\n  const color = getRatingColor(rating, settings);\n  try {\n    return new window.ymaps.GeoObject({\n      geometry: {\n        type: 'Polygon',\n        coordinates: coordinates.map(coord => coord.reverse())\n      },\n      properties: {\n        hintContent: `Рейтинг: ${rating}`,\n        balloonContent: `Рейтинг: ${rating}`\n      }\n    }, {\n      fillColor: settings.polygonColor,\n      strokeColor: '#0000ff',\n      opacity: settings.polygonOpacity\n    });\n  } catch (error) {\n    console.error('Ошибка при создании полигона:', error);\n    return null;\n  }\n};\nconst getRatingColor = (rating, settings) => {\n  return settings.polygonColor; // Используем цвет из настроек\n};\nexport { handleZoneButtonClick, clearZones, fetchZoneData, processPolygon, getRatingColor };","map":{"version":3,"names":["handleZoneButtonClick","mapRef","zoneRectangles","setZoneRectangles","objectsAdded","setObjectsAdded","settings","fetchZoneData","clearZones","current","forEach","rectangle","geoObjects","remove","fetch","then","response","json","data","polygonLayers","map","item","polygon","rating","coordinates","processPolygon","console","error","filter","layer","newZoneRectangles","add","push","catch","color","getRatingColor","window","ymaps","GeoObject","geometry","type","coord","reverse","properties","hintContent","balloonContent","fillColor","polygonColor","strokeColor","opacity","polygonOpacity"],"sources":["C:/Users/Disve/Desktop/YandexMap ES/client/src/zoneHandler.js"],"sourcesContent":["const handleZoneButtonClick = (mapRef, zoneRectangles, setZoneRectangles, objectsAdded, setObjectsAdded, settings) => {\r\n  if (!objectsAdded) {\r\n    fetchZoneData(mapRef, setZoneRectangles, settings);\r\n    setObjectsAdded(true);\r\n  } else {\r\n    clearZones(mapRef, zoneRectangles, setZoneRectangles);\r\n    setObjectsAdded(false);\r\n  }\r\n};\r\n  \r\n  \r\n  const clearZones = (mapRef, zoneRectangles, setZoneRectangles) => {\r\n    if (mapRef.current) {\r\n      zoneRectangles.forEach((rectangle) => {\r\n        mapRef.current.geoObjects.remove(rectangle);\r\n      });\r\n      setZoneRectangles([]);\r\n    }\r\n  };\r\n  \r\n  \r\n  const fetchZoneData = (mapRef, setZoneRectangles, settings) => {\r\n    fetch('http://localhost:5000/api/Zone')\r\n      .then(response => response.json())\r\n      .then(data => {\r\n        const polygonLayers = data.map(item => {\r\n          const { polygon, rating } = item;\r\n          if (polygon && polygon.coordinates) {\r\n            return processPolygon(polygon.coordinates, rating, settings);\r\n          } else {\r\n            console.error('Некорректные данные полигона:', item);\r\n            return null;\r\n          }\r\n        }).filter(layer => layer !== null);\r\n        if (mapRef.current) {\r\n          const newZoneRectangles = [];\r\n          polygonLayers.forEach(layer => {\r\n            mapRef.current.geoObjects.add(layer);\r\n            newZoneRectangles.push(layer);\r\n          });\r\n          setZoneRectangles(newZoneRectangles);\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.error('Ошибка при получении данных полигонов:', error);\r\n      });\r\n  };\r\n  \r\n  const processPolygon = (coordinates, rating, settings) => {\r\n    const color = getRatingColor(rating, settings);\r\n    try {\r\n      return new window.ymaps.GeoObject({\r\n        geometry: {\r\n          type: 'Polygon',\r\n          coordinates: coordinates.map(coord => coord.reverse()),\r\n        },\r\n        properties: {\r\n          hintContent: `Рейтинг: ${rating}`,\r\n          balloonContent: `Рейтинг: ${rating}`,\r\n        },\r\n      }, {\r\n        fillColor: settings.polygonColor,\r\n        strokeColor: '#0000ff',\r\n        opacity: settings.polygonOpacity,\r\n      });\r\n    } catch (error) {\r\n      console.error('Ошибка при создании полигона:', error);\r\n      return null;\r\n    }\r\n  };\r\n  \r\n  const getRatingColor = (rating, settings) => {\r\n    return settings.polygonColor; // Используем цвет из настроек\r\n  };\r\n  \r\n  \r\n  export { handleZoneButtonClick, clearZones, fetchZoneData, processPolygon, getRatingColor };\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}